{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"../api/services/packet.service\";\nimport * as i2 from \"../auth/auth.service\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"@angular/forms\";\nfunction PacketComponent_div_5_div_25_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r10 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 16)(1, \"label\");\n    i0.ɵɵtext(2, \"Select Months:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"select\", 17);\n    i0.ɵɵlistener(\"ngModelChange\", function PacketComponent_div_5_div_25_Template_select_ngModelChange_3_listener($event) {\n      i0.ɵɵrestoreView(_r10);\n      const packet_r3 = i0.ɵɵnextContext().$implicit;\n      return packet_r3.selectedMonths = $event;\n    });\n    i0.ɵɵelementStart(4, \"option\", 18);\n    i0.ɵɵtext(5, \"1 Month\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"option\", 19);\n    i0.ɵɵtext(7, \"3 Months\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"option\", 20);\n    i0.ɵɵtext(9, \"6 Months\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"option\", 21);\n    i0.ɵɵtext(11, \"12 Months\");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const packet_r3 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngModel\", packet_r3.selectedMonths);\n  }\n}\nfunction PacketComponent_div_5_div_26_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\")(1, \"button\", 22);\n    i0.ɵɵtext(2, \"Buy Now\");\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction PacketComponent_div_5_ng_template_27_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"button\", 23);\n    i0.ɵɵtext(1, \"Purchased\");\n    i0.ɵɵelementEnd();\n  }\n}\nconst _c0 = function (a0, a1, a2) {\n  return {\n    \"bg-silver\": a0,\n    \"bg-golden\": a1,\n    \"bg-platinum\": a2\n  };\n};\nfunction PacketComponent_div_5_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r13 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 6)(1, \"div\", 7)(2, \"div\", 8)(3, \"h4\", 9);\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(5, \"div\", 10)(6, \"h5\", 9);\n    i0.ɵɵtext(7, \"Prices:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"ul\", 11)(9, \"li\");\n    i0.ɵɵtext(10);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"li\");\n    i0.ɵɵtext(12);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"li\");\n    i0.ɵɵtext(14);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(15, \"li\");\n    i0.ɵɵtext(16);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(17, \"h5\", 9);\n    i0.ɵɵtext(18, \"Percentage Details:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(19, \"ul\", 11)(20, \"li\");\n    i0.ɵɵtext(21);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(22, \"li\");\n    i0.ɵɵtext(23);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(24, \"form\", 12);\n    i0.ɵɵlistener(\"ngSubmit\", function PacketComponent_div_5_Template_form_ngSubmit_24_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r13);\n      const packet_r3 = restoredCtx.$implicit;\n      const ctx_r12 = i0.ɵɵnextContext();\n      return ctx_r12.openCardPopup(packet_r3.name, packet_r3.selectedMonths);\n    });\n    i0.ɵɵtemplate(25, PacketComponent_div_5_div_25_Template, 12, 1, \"div\", 13);\n    i0.ɵɵtemplate(26, PacketComponent_div_5_div_26_Template, 3, 0, \"div\", 14);\n    i0.ɵɵtemplate(27, PacketComponent_div_5_ng_template_27_Template, 2, 0, \"ng-template\", null, 15, i0.ɵɵtemplateRefExtractor);\n    i0.ɵɵelementEnd()()()();\n  }\n  if (rf & 2) {\n    const packet_r3 = ctx.$implicit;\n    const _r6 = i0.ɵɵreference(28);\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction3(11, _c0, packet_r3.name === \"Silver\", packet_r3.name === \"Golden\", packet_r3.name === \"Platinum\"));\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(packet_r3.name);\n    i0.ɵɵadvance(6);\n    i0.ɵɵtextInterpolate1(\"1 Month: $\", packet_r3.price1, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"3 Months: $\", packet_r3.price3, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"6 Months: $\", packet_r3.price6, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"12 Months: $\", packet_r3.price12, \"\");\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate1(\"Purchase Percent: \", packet_r3.purchasePercent, \"%\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Cancel Percent: \", packet_r3.cancelPercent, \"%\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", packet_r3.id !== ctx_r0.PacketResponseDto.packetId);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", packet_r3.id !== ctx_r0.PacketResponseDto.packetId)(\"ngIfElse\", _r6);\n  }\n}\nfunction PacketComponent_div_6_div_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 36);\n    i0.ɵɵtext(1, \" Please enter a valid card number. \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction PacketComponent_div_6_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r16 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 24)(1, \"div\", 25)(2, \"h5\");\n    i0.ɵɵtext(3, \"Enter Card Details\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"div\", 16)(5, \"label\", 26);\n    i0.ɵɵtext(6, \"Card Number\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"input\", 27);\n    i0.ɵɵlistener(\"ngModelChange\", function PacketComponent_div_6_Template_input_ngModelChange_7_listener($event) {\n      i0.ɵɵrestoreView(_r16);\n      const ctx_r15 = i0.ɵɵnextContext();\n      return ctx_r15.cardNumber = $event;\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(8, PacketComponent_div_6_div_8_Template, 2, 0, \"div\", 28);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"div\", 16)(10, \"label\", 29);\n    i0.ɵɵtext(11, \"Expiry Date\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"input\", 30);\n    i0.ɵɵlistener(\"ngModelChange\", function PacketComponent_div_6_Template_input_ngModelChange_12_listener($event) {\n      i0.ɵɵrestoreView(_r16);\n      const ctx_r17 = i0.ɵɵnextContext();\n      return ctx_r17.expiryDate = $event;\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(13, \"div\", 16)(14, \"label\", 31);\n    i0.ɵɵtext(15, \"CVV\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(16, \"input\", 32);\n    i0.ɵɵlistener(\"ngModelChange\", function PacketComponent_div_6_Template_input_ngModelChange_16_listener($event) {\n      i0.ɵɵrestoreView(_r16);\n      const ctx_r18 = i0.ɵɵnextContext();\n      return ctx_r18.cvv = $event;\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(17, \"div\", 33)(18, \"button\", 34);\n    i0.ɵɵlistener(\"click\", function PacketComponent_div_6_Template_button_click_18_listener() {\n      i0.ɵɵrestoreView(_r16);\n      const ctx_r19 = i0.ɵɵnextContext();\n      return ctx_r19.submitCardDetails();\n    });\n    i0.ɵɵtext(19, \"Submit\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(20, \"button\", 35);\n    i0.ɵɵlistener(\"click\", function PacketComponent_div_6_Template_button_click_20_listener() {\n      i0.ɵɵrestoreView(_r16);\n      const ctx_r20 = i0.ɵɵnextContext();\n      return ctx_r20.closePopup();\n    });\n    i0.ɵɵtext(21, \"Cancel\");\n    i0.ɵɵelementEnd()()()();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(7);\n    i0.ɵɵproperty(\"ngModel\", ctx_r1.cardNumber);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.cardNumberInvalid);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngModel\", ctx_r1.expiryDate);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngModel\", ctx_r1.cvv);\n  }\n}\nfunction PacketComponent_div_7_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r22 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 37);\n    i0.ɵɵtext(1, \" Packet Payment has been successful! \");\n    i0.ɵɵelementStart(2, \"button\", 38);\n    i0.ɵɵlistener(\"click\", function PacketComponent_div_7_Template_button_click_2_listener() {\n      i0.ɵɵrestoreView(_r22);\n      const ctx_r21 = i0.ɵɵnextContext();\n      return ctx_r21.closeSuccessAlert();\n    });\n    i0.ɵɵelementStart(3, \"span\", 39);\n    i0.ɵɵtext(4, \"\\u00D7\");\n    i0.ɵɵelementEnd()()();\n  }\n}\nexport let PacketComponent = /*#__PURE__*/(() => {\n  class PacketComponent {\n    constructor(packetService, authService) {\n      this.packetService = packetService;\n      this.authService = authService;\n      this.email = '';\n      this.selectedMonths = 0;\n      this.showCardInsertionPopup = false;\n      this.showSuccessAlert = false;\n      this.packetId = 0; // Initialize packetId\n      this.cardNumber = '';\n      this.expiryDate = '';\n      this.cvv = '';\n      this.currentPacketName = '';\n    }\n    ngOnInit() {\n      this.loadPackets();\n    }\n    loadPackets() {\n      this.packetService.getPackets(this.authService.currentUser.email).subscribe(response => {\n        this.PacketResponseDto = response;\n      }, error => {\n        console.error('Error fetching packets:', error);\n        // Handle error as per your application's requirements\n      });\n    }\n    openCardPopup(packetName, selectedMonths) {\n      if (!this.authService.isAuthorized()) {\n        alert('Please log in to buy a packet.');\n        return;\n      }\n      this.currentPacketName = packetName;\n      this.selectedMonths = selectedMonths;\n      this.showCardInsertionPopup = true;\n      document.body.classList.add('no-scroll'); // Disable scroll\n    }\n    submitCardDetails() {\n      var _a;\n      if (!this.cardNumber || !this.expiryDate || !this.cvv) {\n        alert('Please enter all card details.');\n        return;\n      }\n      const userEmail = ((_a = this.authService.currentUser) === null || _a === void 0 ? void 0 : _a.email) || '';\n      this.packetService.buyPacket(userEmail, this.currentPacketName, this.selectedMonths).subscribe(response => {\n        this.showSuccessAlert = true;\n        this.closePopup();\n        console.log('Packet bought successfully:', response);\n        this.updatePacketInfoInSesssion(response.id, response.purchasePercent, response.cancelPercent);\n      }, error => {\n        console.error('Error buying packet:', error);\n      });\n    }\n    updatePacketInfoInSesssion(packetId, purchasePercent, cancelPercent) {\n      const userJson = sessionStorage.getItem('CurrentUser');\n      if (userJson) {\n        const user = JSON.parse(userJson);\n        user.packetid = packetId;\n        user.purchasepercent = purchasePercent;\n        user.cancelpercent = cancelPercent;\n        sessionStorage.setItem('CurrentUser', JSON.stringify(user));\n      }\n    }\n    closePopup() {\n      this.showCardInsertionPopup = false;\n      document.body.classList.remove('no-scroll'); // Enable scroll\n      setTimeout(location.reload.bind(location), 1000);\n    }\n    closeSuccessAlert() {\n      this.showSuccessAlert = false;\n    }\n    get cardNumberInvalid() {\n      return this.cardNumber.length < 16 || isNaN(Number(this.cardNumber));\n    }\n  }\n  PacketComponent.ɵfac = function PacketComponent_Factory(t) {\n    return new (t || PacketComponent)(i0.ɵɵdirectiveInject(i1.PacketService), i0.ɵɵdirectiveInject(i2.AuthService));\n  };\n  PacketComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: PacketComponent,\n    selectors: [[\"app-packet\"]],\n    decls: 8,\n    vars: 3,\n    consts: [[1, \"text-md-center\", \"m-5\"], [1, \"container\"], [1, \"row\"], [\"class\", \"col-lg-4 col-md-6 mb-4\", 4, \"ngFor\", \"ngForOf\"], [\"class\", \"popup-overlay\", 4, \"ngIf\"], [\"class\", \"alert alert-success alert-dismissible fade show\", \"role\", \"alert\", 4, \"ngIf\"], [1, \"col-lg-4\", \"col-md-6\", \"mb-4\"], [1, \"card\", \"h-100\", \"shadow\"], [1, \"card-header\", 3, \"ngClass\"], [1, \"card-title\"], [1, \"card-body\", \"bg-dark-grey\"], [1, \"list-unstyled\", \"mb-4\"], [3, \"ngSubmit\"], [\"class\", \"form-group\", 4, \"ngIf\"], [4, \"ngIf\", \"ngIfElse\"], [\"boughtPacket\", \"\"], [1, \"form-group\"], [\"name\", \"selectedMonths\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"value\", \"1\"], [\"value\", \"3\"], [\"value\", \"6\"], [\"value\", \"12\"], [\"type\", \"submit\", 1, \"btn\", \"btn-primary\"], [\"type\", \"button\", \"disabled\", \"\", 1, \"btn\", \"btn-primary\"], [1, \"popup-overlay\"], [1, \"card-insertion-popup\"], [\"for\", \"cardNumber\", 1, \"paymentPopupTitleName1\"], [\"type\", \"text\", \"id\", \"cardNumber\", \"placeholder\", \"Enter card number\", \"required\", \"\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"class\", \"invalid-feedback\", 4, \"ngIf\"], [\"for\", \"expiryDate\", 1, \"paymentPopupTitleName2\"], [\"type\", \"text\", \"id\", \"expiryDate\", \"placeholder\", \"MM/YY\", \"required\", \"\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"for\", \"cvv\", 1, \"paymentPopupTitleName3\"], [\"type\", \"text\", \"id\", \"cvv\", \"placeholder\", \"CVV\", \"required\", \"\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [1, \"form-group\", \"text-center\"], [1, \"btn\", \"btn-primary\", 3, \"click\"], [1, \"btn\", \"btn-secondary\", 3, \"click\"], [1, \"invalid-feedback\"], [\"role\", \"alert\", 1, \"alert\", \"alert-success\", \"alert-dismissible\", \"fade\", \"show\"], [\"type\", \"button\", \"aria-label\", \"Close\", 1, \"close\", 3, \"click\"], [\"aria-hidden\", \"true\"]],\n    template: function PacketComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelement(0, \"head\");\n        i0.ɵɵelementStart(1, \"h5\", 0);\n        i0.ɵɵtext(2, \"Available Packets & Special Offers\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(3, \"div\", 1)(4, \"div\", 2);\n        i0.ɵɵtemplate(5, PacketComponent_div_5_Template, 29, 15, \"div\", 3);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵtemplate(6, PacketComponent_div_6_Template, 22, 4, \"div\", 4);\n        i0.ɵɵtemplate(7, PacketComponent_div_7_Template, 5, 0, \"div\", 5);\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"ngForOf\", ctx.PacketResponseDto.packets);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.showCardInsertionPopup);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.showSuccessAlert);\n      }\n    },\n    directives: [i3.NgForOf, i3.NgClass, i4.ɵNgNoValidate, i4.NgControlStatusGroup, i4.NgForm, i3.NgIf, i4.SelectControlValueAccessor, i4.NgControlStatus, i4.NgModel, i4.NgSelectOption, i4.ɵNgSelectMultipleOption, i4.DefaultValueAccessor, i4.RequiredValidator],\n    styles: [\".bg-silver[_ngcontent-%COMP%]{background-color:silver;color:#fff}.bg-golden[_ngcontent-%COMP%]{background-color:gold;color:#fff}.bg-platinum[_ngcontent-%COMP%]{background-color:#1b4f72;color:#fff}.bg-dark-grey[_ngcontent-%COMP%]{background-color:#343a40;color:#fff}.card[_ngcontent-%COMP%]{border:1px solid #ddd;border-radius:.5rem;box-shadow:0 4px 8px #0003;transition:all .3s ease-in-out}.card[_ngcontent-%COMP%]:hover{box-shadow:0 8px 16px #0006;transform:translateY(-5px)}.form-group[_ngcontent-%COMP%]{margin-bottom:1rem}select.form-control[_ngcontent-%COMP%]{background-color:#f8f9fa;border:1px solid #ced4da;border-radius:.25rem}button.btn-primary[_ngcontent-%COMP%]{background-color:#007bff;border-color:#007bff;transition:background-color .3s ease-in-out,transform .3s ease-in-out}button.btn-primary[_ngcontent-%COMP%]:hover{background-color:#0056b3;transform:scale(1.05)}.popup-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.7);display:flex;justify-content:center;align-items:center;z-index:1000}.card-insertion-popup[_ngcontent-%COMP%]{background:white;padding:30px;border-radius:15px;box-shadow:0 0 20px #0000004d;z-index:1001;width:350px;text-align:center}.card-insertion-popup[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{font-size:1.5rem;margin-bottom:20px;color:#333}.card-insertion-popup[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{margin-bottom:15px}.card-insertion-popup[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{border-radius:10px;border:1px solid #ced4da;padding:10px;font-size:1rem}.card-insertion-popup[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]{background-color:#007bff;border-color:#007bff;border-radius:10px;padding:10px 20px;font-size:1rem;margin-right:10px}.card-insertion-popup[_ngcontent-%COMP%]   .btn-secondary[_ngcontent-%COMP%]{background-color:#6c757d;border-color:#6c757d;border-radius:10px;padding:10px 20px;font-size:1rem}.card-insertion-popup[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]:hover, .card-insertion-popup[_ngcontent-%COMP%]   .btn-secondary[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 8px #0003}.card-insertion-popup[_ngcontent-%COMP%]   .invalid-feedback[_ngcontent-%COMP%]{color:red;font-size:.9rem}.paymentPopupTitleName1[_ngcontent-%COMP%]{margin-left:-12em}.paymentPopupTitleName2[_ngcontent-%COMP%]{margin-left:-13em}.paymentPopupTitleName3[_ngcontent-%COMP%]{margin-left:-16em}.alert[_ngcontent-%COMP%]{position:fixed;top:20px;right:20px;z-index:1002}.alert[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]{font-size:1.5rem;color:#6c757d;position:absolute;top:10px;right:15px;cursor:pointer;background:none;border:none;padding:0}.alert[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]:hover{color:#343a40}\"]\n  });\n  return PacketComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}